# ü§ñ Excel Telegram Bot —Å DeepSeek AI

Telegram –±–æ—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Excel —Ñ–∞–π–ª–∞–º–∏, PostgreSQL –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –∏ DeepSeek API. –ë–æ—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å Excel —Ñ–∞–π–ª—ã, –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏—Ö, —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –ë–î –∏ –¥–µ–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ.

## üåü –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üì§ **–ó–∞–≥—Ä—É–∑–∫–∞ Excel —Ñ–∞–π–ª–æ–≤** (.xlsx, .xls, .xlsm, .csv)
- üìä **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑** –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL
- üîç **–ü—Ä–æ—Å—Ç—ã–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã** (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä)
- ‚úçÔ∏è **–ó–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö –æ–±—ã—á–Ω—ã–º —è–∑—ã–∫–æ–º**
- üì• **–≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤** –æ–±—Ä–∞—Ç–Ω–æ –≤ Excel
- üß† **–£–º–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è** —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é AI
- üë• **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤** (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ, –ø–æ–∏—Å–∫, –∏–º–ø–æ—Ä—Ç, —ç–∫—Å–ø–æ—Ä—Ç)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8 –∏–ª–∏ –≤—ã—à–µ
- PostgreSQL 12 –∏–ª–∏ –≤—ã—à–µ
- Telegram Bot Token (–ø–æ–ª—É—á–∏—Ç—å —É [@BotFather](https://t.me/botfather))
- DeepSeek API –∫–ª—é—á (–ø–æ–ª—É—á–∏—Ç—å –Ω–∞ [platform.deepseek.com](https://platform.deepseek.com))

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PostgreSQL

–°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:

```bash
# –í–æ–π–¥–∏—Ç–µ –≤ PostgreSQL
psql -U postgres

# –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
CREATE DATABASE excel_bot;

# –í—ã–π–¥–∏—Ç–µ
\q
```

### 3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `.env.example` –≤ `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

```bash
cp .env.example .env
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env`:

```env
TELEGRAM_BOT_TOKEN=8376816847:AAHIZW9X6GvxikBAFoLw–óB76BjddeoBmCD0
DB_HOST=127.0.0.1
DB_PORT=32768
DB_NAME=postgres
DB_USER=postgres
DB_PASSWORD=PostgresRoot_2025
DEEPSEEK_API_KEY=–≤–∞—à_–∫–ª—é—á_deepseek
BOT_ACCESS_PASSWORD=1801
```

### 4. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞. –°—Ö–µ–º–∞ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ –∏–∑ —Ñ–∞–π–ª–∞ `schema.sql`.

–ò–ª–∏ –≤—ã –º–æ–∂–µ—Ç–µ –≤—Ä—É—á–Ω—É—é –≤—ã–ø–æ–ª–Ω–∏—Ç—å:

```bash
psql -U postgres -d excel_bot -f schema.sql
```

### 5. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

```bash
python bot.py
```

–ë–æ—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ! üéâ

## üìã –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

- –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏ –±–æ—Ç –ø–æ–ø—Ä–æ—Å–∏—Ç –ø–∞—Ä–æ–ª—å ‚Äî –≤–≤–µ–¥–∏—Ç–µ `1801`
- –ó–Ω–∞—á–µ–Ω–∏–µ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `BOT_ACCESS_PASSWORD`
- –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤–≤–æ–¥–∞ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é —Å –∫–Ω–æ–ø–∫–∞–º–∏

### –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤

1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ Excel —Ñ–∞–π–ª –±–æ—Ç—É –∫–∞–∫ –¥–æ–∫—É–º–µ–Ω—Ç
2. –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ñ–∞–π–ª
3. –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
4. –í—ã –ø–æ–ª—É—á–∏—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —Ñ–∞–π–ª—É

### –ó–∞–ø—Ä–æ—Å—ã –∫ –¥–∞–Ω–Ω—ã–º

–ó–∞–¥–∞–≤–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å—ã –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ:

```
–ü–æ–∫–∞–∂–∏ –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ñ–∞–π–ª–∞
–°–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π –≤ –±–∞–∑–µ?
–ù–∞–π–¥–∏ –≤—Å–µ –∑–∞–ø–∏—Å–∏ –≥–¥–µ —Å—É–º–º–∞ –±–æ–ª—å—à–µ 1000
–ü–æ–∫–∞–∂–∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–æ–ª–æ–Ω–∫–µ "–Ω–∞–∑–≤–∞–Ω–∏–µ"
–ö–∞–∫–∏–µ —Ñ–∞–π–ª—ã —è –∑–∞–≥—Ä—É–∂–∞–ª?
```

–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤–∞—à –∑–∞–ø—Ä–æ—Å –≤ SQL
- –í—ã–ø–æ–ª–Ω–∏—Ç –∑–∞–ø—Ä–æ—Å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –ø–æ–Ω—è—Ç–Ω–æ–º –≤–∏–¥–µ

### –ó–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –∑–∞–ø–∏—Å–∏ –¥–∞–Ω–Ω—ã—Ö:

```
–ó–∞–ø–∏—à–∏: –Ω–∞–∑–≤–∞–Ω–∏–µ = –Ø–±–ª–æ–∫–∏, —Ü–µ–Ω–∞ = 100, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ = 50
–î–æ–±–∞–≤—å: –∫–ª–∏–µ–Ω—Ç –ò–≤–∞–Ω–æ–≤, —Å—É–º–º–∞ 5000
–°–æ—Ö—Ä–∞–Ω–∏: –ø—Ä–æ–¥—É–∫—Ç –ì—Ä—É—à–∏, —Ü–µ–Ω–∞ 120
```

### –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

–ü–æ—Å–ª–µ –ª—é–±–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞, –∫–æ—Ç–æ—Ä—ã–π –≤–µ—Ä–Ω—É–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –≤—ã –º–æ–∂–µ—Ç–µ:
- –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "üì• –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Excel"
- –ò–ª–∏ –Ω–∞–ø–∏—Å–∞—Ç—å "—ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π —ç—Ç–æ –≤ Excel"

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `/employees`, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é. –î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:

- **‚ûï –î–æ–±–∞–≤–∏—Ç—å** ‚Äî –≤–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –∏ –§–ò–û, –Ω–∞–ø—Ä–∏–º–µ—Ä `–î4 - –ö–∞–ª–∏–Ω–∏–Ω–∞ –î–∞—Ä—å—è –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–Ω–∞`
- **‚ûñ –£–¥–∞–ª–∏—Ç—å** ‚Äî —É–∫–∞–∂–∏—Ç–µ –∫–æ–¥ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
- **üîç –ù–∞–π—Ç–∏ –ø–æ –∫–æ–¥—É** ‚Äî –±–æ—Ç –≤—ã–¥–∞—Å—Ç –§–ò–û
- **üìã –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫** ‚Äî –ø–æ–∫–∞–∂–µ—Ç –ø–µ—Ä–≤—ã–µ 20 –∑–∞–ø–∏—Å–µ–π –∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç —ç–∫—Å–ø–æ—Ä—Ç
- **üì• –ò–º–ø–æ—Ä—Ç —Ç–µ–∫—Å—Ç–∞** ‚Äî –≤—Å—Ç–∞–≤—å—Ç–µ —Å–ø–∏—Å–æ–∫ –≤–∏–¥–∞ `–§–ò–û\n–ö–æ–¥`
- **üì• –≠–∫—Å–ø–æ—Ä—Ç —Å–ø–∏—Å–∫–∞ (Excel)** ‚Äî —Ü–µ–ª–∏–∫–æ–º –≤—ã–≥—Ä—É–∂–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
- **üßº –û—á–∏—Å—Ç–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤** ‚Äî —Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è `–£–î–ê–õ–ò–¢–¨ –í–°–ï–•`

## üõ† –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
exeltest/
‚îú‚îÄ‚îÄ bot.py              # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª Telegram –±–æ—Ç–∞
‚îú‚îÄ‚îÄ database.py         # –ú–æ–¥—É–ª—å —Ä–∞–±–æ—Ç—ã —Å PostgreSQL
‚îú‚îÄ‚îÄ excel_processor.py  # –û–±—Ä–∞–±–æ—Ç–∫–∞ Excel —Ñ–∞–π–ª–æ–≤
‚îú‚îÄ‚îÄ deepseek_api.py     # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DeepSeek API
‚îú‚îÄ‚îÄ employee_parser.py  # –ü–∞—Ä—Å–µ—Ä —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Å–ø–∏—Å–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
‚îú‚îÄ‚îÄ schema.sql          # SQL —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ requirements.txt    # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env.example        # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ README.md           # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üóÑ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `uploaded_files`
–•—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö:
- `id` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- `user_id` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Telegram
- `username` - –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `file_name` - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
- `upload_date` - –¥–∞—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏
- `file_hash` - —Ö–µ—à —Ñ–∞–π–ª–∞
- `row_count` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫

### –¢–∞–±–ª–∏—Ü–∞ `excel_data`
–•—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ Excel —Ñ–∞–π–ª–æ–≤:
- `id` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- `file_id` - —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–∞–π–ª
- `row_number` - –Ω–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏
- `column_name` - –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–ª–æ–Ω–∫–∏
- `column_value` - –∑–Ω–∞—á–µ–Ω–∏–µ
- `data_type`